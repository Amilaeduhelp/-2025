<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Protected Access</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 1rem;
}

.container {
  background: white;
  padding: 2.5rem;
  border-radius: 12px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.3);
  width: 100%;
  max-width: 420px;
  animation: slideIn 0.4s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

.logo {
  text-align: center;
  font-size: 3.5rem;
  margin-bottom: 1rem;
}

h1 {
  color: #333;
  text-align: center;
  margin-bottom: 0.5rem;
  font-size: 1.8rem;
  font-weight: 600;
}

.subtitle {
  text-align: center;
  color: #666;
  margin-bottom: 2rem;
  font-size: 0.95rem;
}

.input-group {
  margin-bottom: 1rem;
}

label {
  display: block;
  margin-bottom: 0.5rem;
  color: #555;
  font-size: 0.9rem;
  font-weight: 500;
}

input {
  width: 100%;
  padding: 0.9rem 1rem;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.3s;
  background: #f9f9f9;
}

input:focus {
  outline: none;
  border-color: #667eea;
  background: white;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

button {
  width: 100%;
  padding: 0.9rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1.05rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  margin-top: 0.5rem;
}

button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); }
button:active { transform: translateY(0); }

.message {
  margin-top: 1rem;
  padding: 0.75rem;
  border-radius: 6px;
  font-size: 0.9rem;
  text-align: center;
  display: none;
  animation: fadeIn 0.3s;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.message.show { display: block; }
.message.error { background: #ffebee; color: #c62828; border: 1px solid #ef5350; }
.message.success { background: #e8f5e9; color: #2e7d32; border: 1px solid #66bb6a; }

.info {
  margin-top: 1.5rem;
  padding: 1rem;
  background: #f0f4ff;
  border-left: 4px solid #667eea;
  border-radius: 4px;
  font-size: 0.85rem;
  color: #555;
  line-height: 1.5;
}

.info strong { color: #667eea; }

.action-buttons {
  margin-top: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.secondary-btn {
  background: white;
  color: #667eea;
  border: 2px solid #667eea;
  font-size: 0.95rem;
  padding: 0.8rem;
  font-weight: 500;
}

.secondary-btn:hover {
  background: #667eea;
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.whatsapp-btn:hover {
  background: #25D366;
  border-color: #25D366;
  color: white;
}

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 1000;
  justify-content: center;
  align-items: center;
  animation: fadeIn 0.3s;
}

.modal.show {
  display: flex;
}

.modal-content {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  animation: slideIn 0.4s ease-out;
}

.modal-content h2 {
  color: #c62828;
  margin-bottom: 1rem;
}

.modal-content p {
  color: #555;
  margin-bottom: 1.5rem;
  line-height: 1.6;
}

.modal-btn {
  padding: 0.8rem 2rem;
  margin: 0.5rem;
  border-radius: 8px;
  border: none;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-primary {
  background: #667eea;
  color: white;
}

.btn-primary:hover {
  background: #5568d3;
}

.warning-box {
  margin-top: 1.5rem;
  padding: 1rem;
  background: #fff3e0;
  border-left: 4px solid #ff9800;
  border-radius: 4px;
  font-size: 0.85rem;
  color: #e65100;
  line-height: 1.5;
}
</style>
</head>
<body>

<div class="container">
  <div class="logo">üîê</div>
  <h1>Protected Access</h1>
  <p class="subtitle">Enter your credentials to continue</p>
  
  <div class="input-group">
    <label for="username">Access Code</label>
    <input type="text" id="username" placeholder="Enter access code" autocomplete="username" autofocus>
  </div>
  
  <div class="input-group">
    <label for="password">Password</label>
    <input type="password" id="password" placeholder="Enter password" autocomplete="current-password">
  </div>
  
  <button onclick="verify()">Access Site</button>
  
  <div class="message" id="msg"></div>
  
  <div class="info">
    <strong>‚ÑπÔ∏è Need access?</strong><br>
    Contact the administrator to receive your access credentials.
  </div>
  
  <div class="warning-box">
    <strong>‚ö†Ô∏è Important:</strong> Only one active session per account is allowed. If you login from another device/browser, your current session will be terminated.
  </div>
  
  <div class="action-buttons">
    <button class="secondary-btn" onclick="window.location.href='price.html'">
      Password ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∑è Access Code ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂±‡∑ö ‡∂ö‡∑ô‡∑É‡∑ö ‡∂Ø?
    </button>
    <button class="secondary-btn" onclick="showContentModal()">
       ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂Ö‡∂±‡∑ä‡∂≠‡∂ª‡∑ä‡∂ú‡∂≠ ‡∑Ä‡∂±‡∑ä‡∂±‡∑ö ‡∂∏‡∑ú‡∂±‡∑Ä‡∑è ‡∂Ø?
    </button>
    <button class="secondary-btn whatsapp-btn" onclick="window.open('https://wa.me/94716637804', '_blank')">
      üì± Contact
    </button>
  </div>
</div>

<div class="modal" id="logoutModal">
  <div class="modal-content">
    <h2>‚ö†Ô∏è Session Terminated</h2>
    <p>Another user has logged in with your credentials. Your session has been terminated for security reasons.</p>
    <button class="modal-btn btn-primary" onclick="closeModal()">OK</button>
  </div>
</div>

<div class="modal" id="contentModal">
  <div class="modal-content" style="max-width: 500px; max-height: 80vh; overflow-y: auto;">
    <h2 style="color: #667eea; margin-bottom: 1.5rem;">üìö ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂Ö‡∂±‡∑ä‡∂≠‡∂ª‡∑ä‡∂ú‡∂≠ ‡∑Ä‡∂±‡∑ä‡∂±‡∑ö ‡∂∏‡∑ú‡∂±‡∑Ä‡∑è ‡∂Ø?</h2>
    <div style="text-align: left; color: #555; line-height: 1.8;">
      <ul style="list-style: none; padding: 0;">
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂Ö‡∂ª‡∑ä‡∂Æ ‡∑É‡∑Ñ‡∑í‡∂≠‡∑Ä ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫ ‡∑Ä‡∑è‡∂ú‡∑ä ‡∂∏‡∑è‡∂Ω‡∑è‡∑Ä (‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∂¥‡∑ô‡∑Ö ‡∑Ñ‡∑è ‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö‡∂ß ‡∂Ö‡∂Ø‡∑è‡∑Ö‡∑Ä)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫ ‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä (‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫, ‡∂∫‡∑î‡∂ª‡∑ù‡∂¥‡∑è ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫, ‡∂â‡∂±‡∑ä‡∂Ø‡∑í‡∂∫‡∑è ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂Ü‡∂Ø‡∂ª‡∑ä‡∑Å ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂¥‡∑ú‡∂≠ (‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∂¥‡∑ô‡∑Ö ‡∑Ñ‡∑è ‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì edupoints (‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∂¥‡∑ô‡∑Ö ‡∑Ñ‡∑è ‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ª‡∂†‡∂±‡∑è‡∂∏‡∂∫ ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± ‡∂Ω‡∑í‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂∏‡∂ú‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑Ä‡∑í‡∂Ø‡∑ä‚Äç‡∂∫‡∑è‡∂Ω ‡∂¥‡∑è‡∂®‡∂∏‡∑è‡∂Ω‡∑è ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì Z-Score (‡∂¥‡∑É‡∑î‡∂ú‡∑í‡∂∫ ‡∑Ä‡∑É‡∂ª ‡∂ö‡∑í‡∑Ñ‡∑í‡∂¥‡∂∫‡∂ö)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì Job mart (‡∂ª‡∑ê‡∂ö‡∑í‡∂∫‡∑è ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂ª‡∑è‡∂¢‡∂ö‡∑è‡∂ª‡∑ì ‡∂Ω‡∑ö‡∂õ‡∂±</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂∏‡∑ô‡∂≠‡∑ô‡∂ö‡∑ä ‡∂Ü ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± ‡∂ö‡∑ä‡∑Ç‡∑ö‡∂≠‡∑ä‚Äç‡∂ª (‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì Smart ‡∑É‡∑í‡∂≠‡∑í‡∂∫‡∂∏‡∑ä ‡∂¥‡∑ú‡∂≠ (‡∂ã‡∑É‡∑É‡∑ä ‡∂¥‡∑ô‡∑Ö ‡∑Ñ‡∑è ‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∂¥‡∑ô‡∑Ö ‡∑É‡∂≥‡∑Ñ‡∑è)</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì MCQ test ‡∂ë‡∂ö‡∂ö‡∑í‡∂±‡∑ä ‡∂î‡∂∂‡∑ö ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂∂‡∂Ω‡∑è ‡∂ú‡∂±‡∑ä‡∂±</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∑Ä‡∑ò‡∂≠‡∑ä‡∂≠‡∑ì‡∂∫ ‡∑Ö‡∑ê‡∂Ø‡∑í‡∂∫‡∑è ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∂´‡∂∫</li>
        <li style="padding: 0.6rem 0; border-bottom: 1px solid #eee;">‚úì ‡∂¥‡∑ú‡∂≠‡∑ä‡∑Ñ‡∂Ω</li>
        <li style="padding: 0.6rem 0;">‚úì Y-Sub (‡∑Ä‡∑í‡∑Ä‡∑í‡∂∞ ‡∑Ä‡∑í‡∑Ç‡∂∫‡∂∫‡∂±‡∑ä ‡∑Ñ‡∑ê‡∂Ø‡∑ë‡∂ª‡∑ì‡∂∏‡∑ö ‡∑Ä‡∑ê‡∂Ø‡∂ú‡∂≠‡∑ä‡∂ö‡∂∏‡∑ä)</li>
      </ul>
    </div>
    <button class="modal-btn btn-primary" onclick="closeContentModal()" style="margin-top: 1.5rem; width: 100%;">‡∑Ñ‡∂ª‡∑í</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
var config = {
  redirectUrl: "https://amilaeduhelp.github.io/-2025/entrence.html",
  sessionTimeout: 24
};

var credentials = {
  "USER001": "8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92",
  "USER002": "481f6cc0511143ccdd7e2d1b1b94faf0a700a8b49cd13922a70b5ae28acaa8c5",
  "USER003": "5906ac361a137e2d286465cd6588ebb5ac3f5ae955001100bc41577c3d751764",
  "CUST001": "03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4",
  "CUST002": "8bb0cf6eb9b17d0f7d22b456f121257dc1254e1f01665370476383ea776df414",
  "ADMIN": "240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9",
  "CUST100": "dc658816b8b6be963b4ae5ae4c6befcceb8ac9a8f24b02b7ba1f2e33966137e7",
  "LAK100": "fd3ae3b595e9df173e5ad2163b1053f7cc606df00629da74958b0acc7a1d32e3"
};

var mySessionId = generateSessionId();
var myUser = null;
var channel = null;

function hash(str) {
  return CryptoJS.SHA256(str).toString();
}

function generateSessionId() {
  return Date.now().toString(36) + Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2);
}

function show(text, type) {
  var m = document.getElementById('msg');
  m.textContent = text;
  m.className = 'message show ' + type;
}

function showLogoutModal() {
  document.getElementById('logoutModal').classList.add('show');
}

function closeModal() {
  document.getElementById('logoutModal').classList.remove('show');
  if (channel) {
    channel.postMessage({
      type: 'logout',
      user: myUser
    });
  }
  sessionStorage.clear();
  window.location.reload();
}

function showContentModal() {
  document.getElementById('contentModal').classList.add('show');
}

function closeContentModal() {
  document.getElementById('contentModal').classList.remove('show');
}

function initBroadcastChannel() {
  if (typeof BroadcastChannel === 'undefined') {
    console.warn('BroadcastChannel not supported');
    return null;
  }
  
  channel = new BroadcastChannel('auth_channel');
  
  channel.onmessage = function(event) {
    var data = event.data;
    
    if (data.type === 'new_login' && data.user === myUser && data.sessionId !== mySessionId) {
      showLogoutModal();
    }
    
    if (data.type === 'check_session' && data.user === myUser) {
      channel.postMessage({
        type: 'session_response',
        user: myUser,
        sessionId: mySessionId,
        timestamp: Date.now()
      });
    }
  };
  
  return channel;
}

function checkForExistingSessions(user) {
  return new Promise(function(resolve) {
    if (!channel) {
      resolve(false);
      return;
    }
    
    var responses = [];
    var checkTimeout;
    
    var responseHandler = function(event) {
      var data = event.data;
      if (data.type === 'session_response' && data.user === user) {
        responses.push(data);
      }
    };
    
    channel.addEventListener('message', responseHandler);
    
    channel.postMessage({
      type: 'check_session',
      user: user
    });
    
    checkTimeout = setTimeout(function() {
      channel.removeEventListener('message', responseHandler);
      resolve(responses.length > 0);
    }, 500);
  });
}

function notifyNewLogin(user) {
  if (channel) {
    channel.postMessage({
      type: 'new_login',
      user: user,
      sessionId: mySessionId,
      timestamp: Date.now()
    });
  }
}

async function verify() {
  var user = document.getElementById('username').value.trim().toUpperCase();
  var pass = document.getElementById('password').value;
  
  if (!user || !pass) {
    show('Please enter both access code and password', 'error');
    return;
  }
  
  var stored = credentials[user];
  
  if (!stored) {
    show('Invalid access code or password', 'error');
    document.getElementById('password').value = '';
    return;
  }
  
  if (hash(pass) === stored) {
    var hasActiveSession = await checkForExistingSessions(user);
    
    if (hasActiveSession) {
      show('‚ö†Ô∏è This account is already active on another tab/window', 'error');
      document.getElementById('password').value = '';
      return;
    }
    
    show('‚úì Access granted! Redirecting...', 'success');
    
    myUser = user;
    
    var expires = new Date();
    expires.setHours(expires.getHours() + config.sessionTimeout);
    
    sessionStorage.setItem('auth', 'true');
    sessionStorage.setItem('user', user);
    sessionStorage.setItem('sessionId', mySessionId);
    sessionStorage.setItem('expires', expires.getTime());
    
    notifyNewLogin(user);
    
    setTimeout(function() {
      window.location.href = config.redirectUrl;
    }, 1200);
  } else {
    show('Invalid access code or password', 'error');
    document.getElementById('password').value = '';
  }
}

document.getElementById('username').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') document.getElementById('password').focus();
});

document.getElementById('password').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') verify();
});

window.addEventListener('beforeunload', function() {
  if (channel && myUser) {
    channel.postMessage({
      type: 'logout',
      user: myUser
    });
  }
});

var auth = sessionStorage.getItem('auth');
var user = sessionStorage.getItem('user');
var sessionId = sessionStorage.getItem('sessionId');
var exp = sessionStorage.getItem('expires');

if (auth === 'true' && user && sessionId && exp && new Date().getTime() < parseInt(exp)) {
  myUser = user;
  mySessionId = sessionId;
  initBroadcastChannel();
  window.location.href = config.redirectUrl;
} else {
  initBroadcastChannel();
}
</script>

</body>
</html>
